{% comment %}
  Expert Team — Grid (Desktop/Tablet) + Mobile Slider (auto-centering)
  Assets needed:
    - assets/section-expert-team.css
    - assets/expert-team-mobile.js
{% endcomment %}

{{ 'section-expert-team.css' | asset_url | stylesheet_tag }}
{{ 'expert-team-mobile.js'   | asset_url | script_tag }}

<section id="expert-team"
         class="expert-team {% if section.settings.center_snap %}center-snap{% endif %}"
         style="--et-bg: {{ section.settings.bg | default: '#F7F7F7' }}; --cols-d: {{ section.settings.columns_desktop | default: 4 }}; --cols-t: {{ section.settings.columns_tablet | default: 2 }};">
  <div class="expert-team__inner page-width">
    {% if section.settings.badge != blank %}
      <p class="expert-team__badge">{{ section.settings.badge }}</p>
    {% endif %}
    {% if section.settings.heading != blank %}
      <h2 class="expert-team__title">{{ section.settings.heading }}</h2>
    {% endif %}
    {% if section.settings.intro != blank %}
      <div class="expert-team__intro rte">{{ section.settings.intro }}</div>
    {% endif %}

    <div class="experts-grid js-experts-slider" role="region" aria-label="{{ section.settings.heading | default: 'Expert:innen' }}">
      {% for block in section.blocks %}
        {% if block.type == 'expert' %}
          <article class="expert-card" {{ block.shopify_attributes }}>
            {% assign _img = block.settings.photo | default: block.settings.image %}
            {% if _img != blank %}
              <div class="expert-card__media">
                {% assign alt_txt = block.settings.alt_text | default: block.settings.name %}
                {{ _img
                  | image_url: width: 1200
                  | image_tag:
                    alt: alt_txt,
                    loading: 'lazy',
                    sizes: '(min-width:1200px) calc((min(1200px, 100vw) - 66px) / var(--cols-d)), (min-width:750px) calc((100vw - 44px) / var(--cols-t)), calc(100vw - 48px)',
                    widths: '360, 540, 720, 900, 1080, 1200' }}
              </div>
            {% endif %}

            <div class="expert-card__body">
              {% if block.settings.name != blank %}
                <h3 class="expert-card__name">{{ block.settings.name }}</h3>
              {% endif %}
              {% if block.settings.role != blank %}
                <p class="expert-card__role">{{ block.settings.role }}</p>
              {% endif %}
              {% if block.settings.bio != blank %}
                <div class="expert-card__text">{{ block.settings.bio }}</div>
              {% endif %}

              {% if section.settings.show_card_link and block.settings.link_url != blank %}
                <a class="expert-card__link" href="{{ block.settings.link_url }}"
                   {% if block.settings.link_new_tab %}target="_blank" rel="noopener noreferrer"{% endif %}>
                  {{ block.settings.link_label | default: 'Mehr erfahren' }}
                </a>
              {% endif %}
            </div>
          </article>
        {% endif %}
      {% endfor %}
    </div>

    <div class="experts-slider-nav">
      <button class="experts-slider-btn prev" type="button" aria-label="Vorherige Karte" disabled>‹</button>
      <button class="experts-slider-btn next" type="button" aria-label="Nächste Karte">›</button>
    </div>

    {% if section.settings.footer_link_url != blank and section.settings.footer_link_label != blank %}
      <div class="experts-footer-link">
        <a class="experts-footer-link__btn" href="{{ section.settings.footer_link_url }}">
          {{ section.settings.footer_link_label }}
        </a>
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Unser Experten-Team",
  "tag": "section",
  "class": "section--expert-team",
  "settings": [
    { "type": "text", "id": "badge", "label": "Eyebrow/Badge", "default": "BitterLiebe knows best" },
    { "type": "text", "id": "heading", "label": "Überschrift", "default": "Unser Experten-Team" },
    { "type": "richtext", "id": "intro", "label": "Intro", "default": "<p>Hinter BitterLiebe steckt ein Team von renommierten Experten aus den Bereichen Ernährung, Gesundheit und Naturheilkunde, die ihr Fachwissen und ihre Leidenschaft für Bitterstoffe bündeln.</p>" },

    { "type": "range", "id": "columns_desktop", "label": "Spalten (Desktop)", "min": 1, "max": 6, "step": 1, "default": 4 },
    { "type": "range", "id": "columns_tablet",  "label": "Spalten (Tablet ≤ 1199px)", "min": 1, "max": 4, "step": 1, "default": 2 },

    { "type": "checkbox", "id": "center_snap", "label": "Auto-Center Snap im Slider (Mobil)", "default": true },

    { "type": "color", "id": "bg", "label": "Hintergrundfarbe", "default": "#F7F7F7" },
    { "type": "range", "id": "pad_y_mobile", "label": "Abstand oben/unten (Mobil)", "min": 20, "max": 120, "step": 2, "default": 40 },
    { "type": "range", "id": "pad_y_desktop", "label": "Abstand oben/unten (Desktop)", "min": 30, "max": 160, "step": 2, "default": 80 },

    { "type": "checkbox", "id": "show_card_link", "label": "„Mehr erfahren“ in Karten zeigen", "default": true },
    { "type": "text", "id": "footer_link_label", "label": "Footer-Button Text", "default": "Mehr über unser Team erfahren" },
    { "type": "url", "id": "footer_link_url", "label": "Footer-Button Link" }
  ],
  "blocks": [
    {
      "type": "expert",
      "name": "Expertenkarte",
      "settings": [
        { "type": "image_picker", "id": "photo", "label": "Foto" },
        { "type": "image_picker", "id": "image", "label": "Foto (kompatibel – alt)", "info": "Nur für Rückwärtskompatibilität. Bitte das neue Feld „Foto“ verwenden." },
        { "type": "text", "id": "alt_text", "label": "Alt-Text (SEO)" },
        { "type": "text", "id": "name", "label": "Name" },
        { "type": "text", "id": "role", "label": "Rolle" },
        { "type": "richtext", "id": "bio", "label": "Kurzbeschreibung" },
        { "type": "text", "id": "link_label", "label": "Link-Label", "default": "Mehr erfahren" },
        { "type": "url", "id": "link_url", "label": "Link URL" },
        { "type": "checkbox", "id": "link_new_tab", "label": "In neuem Tab öffnen", "default": false }
      ]
    }
  ],
  "max_blocks": 12,
  "presets": [
    {
      "name": "Unser Experten-Team",
      "blocks": [
        { "type": "expert", "settings": { "name": "Jana Lebenstedt", "role": "Studierte Ernährungsexpertin (B.SC.)" } },
        { "type": "expert", "settings": { "name": "Lisa Marie Thiele", "role": "Physiotherapeutin & Ernährungsberaterin" } },
        { "type": "expert", "settings": { "name": "Laura Lutz", "role": "Zertifizierte Ernährungsberaterin" } },
        { "type": "expert", "settings": { "name": "Filomena Barth", "role": "Beraterin für Nahrungsergänzungsmittel" } }
      ]
    }
  ]
}
{% endschema %}
